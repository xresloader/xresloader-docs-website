<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>FAQ &mdash; xresloader-document https://xresloader.atframe.work 文档</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=1fb93e06" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=26a91e76"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/translations.js?v=beaddf03"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="author" title="关于此文档" href="../about.html" />
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="next" title="环境和依赖项" href="../development/dependency.html" />
    <link rel="prev" title="生态和周边工具" href="ecosystem_and_tools.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            xresloader-document
              <img src="../_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="搜索文档" aria-label="搜索文档" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="导航菜单">
              <p class="caption" role="heading"><span class="caption-text">用户文档</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="download.html">下载工具集</a></li>
<li class="toctree-l1"><a class="reference internal" href="quick_start.html">快速上手</a></li>
<li class="toctree-l1"><a class="reference internal" href="xresloader_core.html">转表引擎-xresloader</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_mapping.html">协议-&gt;Excel数据映射和支持的配置读取源 （scheme）</a></li>
<li class="toctree-l1"><a class="reference internal" href="output_format.html">数据输出和数据加载</a></li>
<li class="toctree-l1"><a class="reference internal" href="xresconv.html">批量转表工具</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_types.html">数据类型说明</a></li>
<li class="toctree-l1"><a class="reference internal" href="xres_code_generator.html">使用 xres-code-generator 生成解析代码</a></li>
<li class="toctree-l1"><a class="reference internal" href="advance_usage.html">高级功能</a></li>
<li class="toctree-l1"><a class="reference internal" href="ecosystem_and_tools.html">生态和周边工具</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">FAQ</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id1">哪里有完整的示例？</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id2">为什么会读到很多空数据？</a></li>
<li class="toctree-l2"><a class="reference internal" href="#excel">为什么Excel里填的时间，但是转出来是一个负数？</a></li>
<li class="toctree-l2"><a class="reference internal" href="#windows-java-nio-charset-unsupportedcharsetexception-cp65001">Windows下控制台里执行执行会报文件编码错误？（java.nio.charset.UnsupportedCharsetException: cp65001）</a></li>
<li class="toctree-l2"><a class="reference internal" href="#c-xresloader-multiple-definition-of-org-xresloader-pb-xresloader-xxx">C++加载代码编译时出现xresloader符号重定义（multiple definition of <code class="docutils literal notranslate"><span class="pre">org::xresloader::pb::xresloader_XXX）</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#c-xresloader">C++加载代码编译时出现xresloader版本检查错误</a></li>
<li class="toctree-l2"><a class="reference internal" href="#proto-v2apirepeated-wire-type">proto v2版本API解析repeated的整数或浮点数类型字段失败(Wire Type)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#proto-unsigned-uint32uint64-ue-signed-int32-int64">为什么在proto里定义的是一个无符号(unsigned)类型(uint32、uint64等)，实际输出的UE代码是有符号(signed)的(int32/int64)？</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ue-csv-ue-json-name">为什么 <code class="docutils literal notranslate"><span class="pre">UE-Csv</span></code> 和 <code class="docutils literal notranslate"><span class="pre">UE-Json</span></code> 输出的代码会多一个 <code class="docutils literal notranslate"><span class="pre">Name</span></code> 字段?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#excelue">要如何配置可以让Excel里的数据指向UE的类型或资源</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ue-oneof-case-fstring-uenum">为什么UE的代码输出里对 <code class="docutils literal notranslate"><span class="pre">oneof</span></code> 的case输出使用 <code class="docutils literal notranslate"><span class="pre">FString</span></code> 的字段名而不使用 <code class="docutils literal notranslate"><span class="pre">UEnum()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#can-not-reserve-enough-space-for-xxx-objecct-heap">提示 <code class="docutils literal notranslate"><span class="pre">Can</span> <span class="pre">not</span> <span class="pre">reserve</span> <span class="pre">enough</span> <span class="pre">space</span> <span class="pre">for</span> <span class="pre">XXX</span> <span class="pre">objecct</span> <span class="pre">heap</span></code></a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">开发文档</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../development/dependency.html">环境和依赖项</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/build.html">编译和打包</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/pkg_source.html">使用国内的源</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/design_xresloader.html">转表引擎设计模型</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/design_xresconv.html">批量转表工具设计模型</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">其他</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../LICENSE.html">LICENSE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about.html">关于 xresloader</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="移动版导航菜单" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">xresloader-document</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="页面导航">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">FAQ</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/users/faq.rst.txt" rel="nofollow"> 查看页面源码</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="faq">
<h1>FAQ<a class="headerlink" href="#faq" title="Link to this heading"></a></h1>
<section id="id1">
<h2>哪里有完整的示例？<a class="headerlink" href="#id1" title="Link to this heading"></a></h2>
<p>转表功能和二进制数据读取的示例见： <a class="reference external" href="https://github.com/xresloader/xresloader/tree/main/sample">https://github.com/xresloader/xresloader/tree/main/sample</a></p>
<p>文本和Msgpack数据读取示例见： <a class="reference external" href="https://github.com/xresloader/xresloader/tree/main/loader-binding">https://github.com/xresloader/xresloader/tree/main/loader-binding</a></p>
<p>批量转表配置的示例见： <a class="reference external" href="https://github.com/xresloader/xresconv-conf">https://github.com/xresloader/xresconv-conf</a></p>
</section>
<section id="id2">
<h2>为什么会读到很多空数据？<a class="headerlink" href="#id2" title="Link to this heading"></a></h2>
<p>Excel里编辑过的单元格即便删除了也会留下不可见的样式配置，这时候会导致转出的数据有空行。可以通过在Excel里删除行解决</p>
</section>
<section id="excel">
<h2>为什么Excel里填的时间，但是转出来是一个负数？<a class="headerlink" href="#excel" title="Link to this heading"></a></h2>
<p>Excel里的日期时间类型转成协议里整数时会转为Unix时间戳，但是Excel的时间是以1900年1月0号为基准的，这意味着如果时间格式是 <code class="docutils literal notranslate"><span class="pre">hh:mm:ss</span></code> 的话，<code class="docutils literal notranslate"><span class="pre">49:30:01</span></code> 会被转为 <code class="docutils literal notranslate"><span class="pre">1900-1-2</span> <span class="pre">1:31:01</span></code> 。
时间戳因为是相对于 <code class="docutils literal notranslate"><span class="pre">1970-01-01</span> <span class="pre">00:00:00</span></code> 的秒数，所以会是一个绝对值很大的负数。</p>
</section>
<section id="windows-java-nio-charset-unsupportedcharsetexception-cp65001">
<h2>Windows下控制台里执行执行会报文件编码错误？（java.nio.charset.UnsupportedCharsetException: cp65001）<a class="headerlink" href="#windows-java-nio-charset-unsupportedcharsetexception-cp65001" title="Link to this heading"></a></h2>
<p>这个问题涉及的几个Exception是：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ERROR<span class="w"> </span>StatusLogger<span class="w"> </span>Unable<span class="w"> </span>to<span class="w"> </span>inject<span class="w"> </span>fields<span class="w"> </span>into<span class="w"> </span>builder<span class="w"> </span>class<span class="w"> </span><span class="k">for</span><span class="w"> </span>plugin<span class="w"> </span><span class="nb">type</span><span class="w"> </span>class<span class="w"> </span>org.apache.logging.log4j.core.appender.ConsoleAppender,<span class="w"> </span>element<span class="w"> </span>Console.
java.nio.charset.UnsupportedCharsetException:<span class="w"> </span>cp65001
<span class="w">        </span>at<span class="w"> </span>java.nio.charset.Charset.forName<span class="o">(</span>Unknown<span class="w"> </span>Source<span class="o">)</span>
<span class="w">        </span>at<span class="w"> </span>org.apache.logging.log4j.util.PropertiesUtil.getCharsetProperty<span class="o">(</span>PropertiesUtil.java:146<span class="o">)</span>
<span class="w">        </span>at<span class="w"> </span>org.apache.logging.log4j.util.PropertiesUtil.getCharsetProperty<span class="o">(</span>PropertiesUtil.java:134<span class="o">)</span>
<span class="w">        </span>...
...
</pre></div>
</div>
<p>和</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ERROR<span class="w"> </span>StatusLogger<span class="w"> </span>Unable<span class="w"> </span>to<span class="w"> </span>invoke<span class="w"> </span>factory<span class="w"> </span>method<span class="w"> </span><span class="k">in</span><span class="w"> </span>class<span class="w"> </span>class<span class="w"> </span>org.apache.logging.log4j.core.appender.ConsoleAppender<span class="w"> </span><span class="k">for</span><span class="w"> </span>element<span class="w"> </span>Console.
java.lang.IllegalStateException:<span class="w"> </span>No<span class="w"> </span>factory<span class="w"> </span>method<span class="w"> </span>found<span class="w"> </span><span class="k">for</span><span class="w"> </span>class<span class="w"> </span>org.apache.logging.log4j.core.appender.ConsoleAppender
<span class="w">        </span>at<span class="w"> </span>org.apache.logging.log4j.core.config.plugins.util.PluginBuilder.findFactoryMethod<span class="o">(</span>PluginBuilder.java:224<span class="o">)</span>
<span class="w">        </span>at<span class="w"> </span>org.apache.logging.log4j.core.config.plugins.util.PluginBuilder.build<span class="o">(</span>PluginBuilder.java:130<span class="o">)</span>
<span class="w">        </span>at<span class="w"> </span>org.apache.logging.log4j.core.config.AbstractConfiguration.createPluginObject<span class="o">(</span>AbstractConfiguration.java:952<span class="o">)</span>
<span class="w">        </span>...
...
</pre></div>
</div>
<p>这是因为在Windows控制台中，如果编码是UTF-8，java获取编码时会获取到cp65001，而这个编码java本身是不识别的。这种情况可以按下面的方法解决：</p>
<ul class="simple">
<li><p>第一种: 执行xresloader之前先执行 chcp 936，切换到GBK编码</p></li>
<li><p>第二种: 在powershell里执行</p></li>
</ul>
</section>
<section id="c-xresloader-multiple-definition-of-org-xresloader-pb-xresloader-xxx">
<h2>C++加载代码编译时出现xresloader符号重定义（multiple definition of <code class="docutils literal notranslate"><span class="pre">org::xresloader::pb::xresloader_XXX）</span></code><a class="headerlink" href="#c-xresloader-multiple-definition-of-org-xresloader-pb-xresloader-xxx" title="Link to this heading"></a></h2>
<p>pb_header.pb.cc 和 pb_header_v3.pb.cc 只能保留一个</p>
<p>如果系统采用的是proto v3则保留pb_header_v3.pb.cc</p>
<p>如果系统采用的是老版本的proto v2则保留pb_header.pb.cc</p>
</section>
<section id="c-xresloader">
<h2>C++加载代码编译时出现xresloader版本检查错误<a class="headerlink" href="#c-xresloader" title="Link to this heading"></a></h2>
<p>具体表现为编译时输出 <code class="docutils literal notranslate"><span class="pre">This</span> <span class="pre">file</span> <span class="pre">was</span> <span class="pre">generated</span> <span class="pre">by</span> <span class="pre">an</span> <span class="pre">older</span> <span class="pre">version</span> <span class="pre">of</span> <span class="pre">protoc</span> <span class="pre">...</span></code> 或 <code class="docutils literal notranslate"><span class="pre">This</span> <span class="pre">file</span> <span class="pre">was</span> <span class="pre">generated</span> <span class="pre">by</span> <span class="pre">a</span> <span class="pre">newer</span> <span class="pre">version</span> <span class="pre">of</span> <span class="pre">protoc</span> <span class="pre">...</span></code> 。</p>
<p>这是因为protoc版本和目前所用的protobuf版本不一致，请尝试重新用目前所用的protoc根据配置的proto文件和header目录中的 <code class="docutils literal notranslate"><span class="pre">pb_header_v3.proto</span></code> 或 <code class="docutils literal notranslate"><span class="pre">pb_header.proto</span></code> 重新生成c++代码文件。</p>
</section>
<section id="proto-v2apirepeated-wire-type">
<h2>proto v2版本API解析repeated的整数或浮点数类型字段失败(Wire Type)<a class="headerlink" href="#proto-v2apirepeated-wire-type" title="Link to this heading"></a></h2>
<p>我们转表默认使用的是proto v3模式，几乎所有编码规则都是向前兼容到proto v2的，但是也有一个例外，就是repeated的数值类型。</p>
<p>repeated的数值类型在proto v2里默认是 <code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">packed</span> <span class="pre">=</span> <span class="pre">false</span> <span class="pre">]</span></code> 而在proto v3里是 <code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">packed</span> <span class="pre">=</span> <span class="pre">true</span> <span class="pre">]</span></code> 。解决方法是显式指定打包方式。</p>
<p>详见 <a class="reference internal" href="output_format.html#output-format-proto-v2-and-proto-v3"><span class="std std-ref">Proto v2和Proto v3</span></a> 。</p>
</section>
<section id="proto-unsigned-uint32uint64-ue-signed-int32-int64">
<h2>为什么在proto里定义的是一个无符号(unsigned)类型(uint32、uint64等)，实际输出的UE代码是有符号(signed)的(int32/int64)？<a class="headerlink" href="#proto-unsigned-uint32uint64-ue-signed-int32-int64" title="Link to this heading"></a></h2>
<p>因为有一些语言是没有无符号(unsigned)类型的，为了统一数据类型，我们统一转换为有符号类型，转换方式和protobuf的java版SDK保持一致。如果需要使用大于int32最大值的uint32类型，请用int64代替。</p>
</section>
<section id="ue-csv-ue-json-name">
<h2>为什么 <code class="docutils literal notranslate"><span class="pre">UE-Csv</span></code> 和 <code class="docutils literal notranslate"><span class="pre">UE-Json</span></code> 输出的代码会多一个 <code class="docutils literal notranslate"><span class="pre">Name</span></code> 字段?<a class="headerlink" href="#ue-csv-ue-json-name" title="Link to this heading"></a></h2>
<p>因为对 <code class="docutils literal notranslate"><span class="pre">UE-Json</span></code> 输出中， <code class="docutils literal notranslate"><span class="pre">Name</span></code> 是一个特殊字段，也用于UE中内置的接口的查找索引。所以为了统一输出的数据结构（ 这样无论是 <code class="docutils literal notranslate"><span class="pre">UE-Csv</span></code> 还是 <code class="docutils literal notranslate"><span class="pre">UE-Json</span></code> 都可以用相同的代码结构来导入 ），我们对 <code class="docutils literal notranslate"><span class="pre">UE-Csv</span></code> 和 <code class="docutils literal notranslate"><span class="pre">UE-Json</span></code> 统一自动生成 <code class="docutils literal notranslate"><span class="pre">Name</span></code> 字段。但是如果用户自定义了 <code class="docutils literal notranslate"><span class="pre">Name</span></code> 字段， 我们会使用用户自定义的 <code class="docutils literal notranslate"><span class="pre">Name</span></code> 字段。</p>
</section>
<section id="excelue">
<h2>要如何配置可以让Excel里的数据指向UE的类型或资源<a class="headerlink" href="#excelue" title="Link to this heading"></a></h2>
<p>可以使用 <code class="docutils literal notranslate"><span class="pre">org.xresloader.ue.ue_type_name</span></code> 插件和 <code class="docutils literal notranslate"><span class="pre">org.xresloader.ue.ue_type_is_class</span></code> 插件。详见： <a class="reference internal" href="output_format.html#output-format-export-ue"><span class="std std-ref">导出为UE支持的CSV或JSON数据和代码 (可选)</span></a></p>
</section>
<section id="ue-oneof-case-fstring-uenum">
<h2>为什么UE的代码输出里对 <code class="docutils literal notranslate"><span class="pre">oneof</span></code> 的case输出使用 <code class="docutils literal notranslate"><span class="pre">FString</span></code> 的字段名而不使用 <code class="docutils literal notranslate"><span class="pre">UEnum()</span></code><a class="headerlink" href="#ue-oneof-case-fstring-uenum" title="Link to this heading"></a></h2>
<p>主要是因为（当前版本4.X）UE的 <code class="docutils literal notranslate"><span class="pre">UEnum()</span></code> 的支持仅支持基于 <code class="docutils literal notranslate"><span class="pre">uint8</span></code> 的，但是protobuf的field number是 <code class="docutils literal notranslate"><span class="pre">int32</span></code> 。为了兼容性所以没有使用 <code class="docutils literal notranslate"><span class="pre">UEnum()</span></code> 。
如果输出int32的话在UE里不太好操作，所以输出了字符串类型，方便蓝图里或UE代码里通过UE内置的反射机制访问。</p>
</section>
<section id="can-not-reserve-enough-space-for-xxx-objecct-heap">
<h2>提示 <code class="docutils literal notranslate"><span class="pre">Can</span> <span class="pre">not</span> <span class="pre">reserve</span> <span class="pre">enough</span> <span class="pre">space</span> <span class="pre">for</span> <span class="pre">XXX</span> <span class="pre">objecct</span> <span class="pre">heap</span></code><a class="headerlink" href="#can-not-reserve-enough-space-for-xxx-objecct-heap" title="Link to this heading"></a></h2>
<p>在转换很大的Excel文件时（上万行数据），会需要很高的内存（&gt;=1GB）。所以为了方便我们在批量转表sample的xml中配置了 <code class="docutils literal notranslate"><span class="pre">&lt;java_option</span> <span class="pre">desc=&quot;java选项-最大内存限制2GB&quot;&gt;-Xmx2048m&lt;/java_option&gt;</span></code> 。
如果出现这个提示可能是32位jre无法分配这么多地址空间导致的，可以在xml里删除这个配置。但是还是建议使用64位jre。</p>
<p>在 v2.10.0 版本以后，可以通过使用 <code class="docutils literal notranslate"><span class="pre">--disable-excel-formular</span></code> 关闭公式实时计算，这时候会使用内部的索引器，能够大幅降低内存和CPU开销。</p>
<p>&gt; 关闭公式实时计算并不是指不支持公式。Excel在保存时会保存一份公式计算结果的缓存，关闭公式实时计算后会使用这个缓存。</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="页脚">
        <a href="ecosystem_and_tools.html" class="btn btn-neutral float-left" title="生态和周边工具" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> 上一页</a>
        <a href="../development/dependency.html" class="btn btn-neutral float-right" title="环境和依赖项" accesskey="n" rel="next">下一页 <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; 版权所有 2024, xresloader。</p>
  </div>

  利用 <a href="https://www.sphinx-doc.org/">Sphinx</a> 构建，使用的 
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">主题</a>
    由 <a href="https://readthedocs.org">Read the Docs</a> 开发.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>